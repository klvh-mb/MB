<header>
	<div data-ng-include style="width: 100%;height: 50px;" data-src="'/assets/app/views/headerBar.html'"></div>
</header>

<div class="themeA-container">
	<div>
	    <div class="col-lg-1 col-md-1 col-xs-1" style="width:2%"></div>
		<div class="col-md-2 col-sm-2 col-xs-2" style="width:20%;">
            <div id="main-uphoto" data-ng-style="set_background_image()">
                <img src="/assets/app/images/general/gradient_black_30.png" alt="gradient-black">
                <a title="user-picture" href="#/about/activities"><img src="/get-thumbnail-image-by-id/{{userInfo.id}}" alt="user-picture"></a>
                <a href="#/about/activities" class="userName">{{userInfo.displayName}}</a>
            </div>
			<!--ProfilePicture End -->
			<div ng-controller="AnnouncementsWidgetController">
                <div ng-init="niceScroll()" data-ng-include data-src="'/assets/app/views/announcementsWidget.html'"></div>
            </div>
			<!--Announce End -->
			<div>
                <div id="myShortcuts" class="general-box">
                    <div class="con-title">
                        <a href="/#/" class="text-muted">
                            <img src="/assets/app/images/general/icons/newsfeed.png">我的社群動向
                        </a>
                    </div>
                    <div class="con-title">
                        <a href="/#/about/bookmarks" class="text-muted">
                            <img style="width:22px;height:22px;margin:0 8px 0 3px;" src="/assets/app/images/general/icons/message_favorited.png">我的喜愛
                        </a>
                    </div>
                </div>
            </div>
            <!--Newsfeed shortcut End -->
			<div ng-controller="UserCommunityWidgetController" data-ng-show="result.fvm.length > 0">
                <div ng-init="niceScroll()" data-ng-include data-src="'/assets/app/views/myCommunityWidget.html'"></div>
            </div>
            <!--MyCommunity End -->
		</div>
		<div class="col-md-6 col-sm-6 col-xs-6" style="width:50%;">
			<div id="community-header">
				<ul>
					<li>
                        <div>
                            <img id="community-banner" data-ng-src="{{coverImage}}" />
                            <a data-ng-show="community.isO" ng-click="openGroupCoverPhotoModal(community.id)">
                                <span class="icon-box-2 icon-title-edit-photo"></span>
                                <span class="icon-box-2 icon-box-black-op05"></span>
                            </a>
                        </div>
				    </li>
					<li id="community-header-menu">
						<!--div class="h5">
							<img src="{{community.icon}}"><b>{{community.n}}</b>
						</div-->
						<div class="divider-cus" ng-show="false"></div>
						<div ng-class="{activeTabBold: selectedTab == 1}">
							<a ng-click="selectedTab = 1;">最新訊息</a>
						</div>
						<div class="divider-cus"></div>
						<div ng-class="{activeTabBold: selectedTab == 2}">
							<a ng-click="selectedTab = 2;">成員</a>
						</div>
						<!-- <div class="divider-cus"></div>
						<div ng-class="{activeBold: selectedTab == 3}">
							<a ng-click="selectedTab = 3;">Photo Contest</a>
						</div> -->
						<div class="dropdown pull-right">
                            <a id="community-settings-dropdown" class="toolsbox toolsbox-end dropdown-toggle" data-toggle="dropdown"><span class="icon-title-contentSetup"></span></a>
                            <ul style="right:-60px;" class="subtoolsbox dropdown-menu" aria-labelledby="community-settings-dropdown">
                                <li><a data-ng-click="">分享社群</a></li>
                                <li ng-show="community.isO"><a data-ng-click="">編輯社群</a></li>
                                <li class="dropdown-divider" role="presentation"></li>
                                <li ng-show="!community.isO && community.isM == true" ><a data-ng-click="leave_community(community.id)">退出社群</a></li>
                                <li><a data-ng-click="">檢舉社群</a></li>
                            </ul> 
                        </div>
                        <div class="pull-right">
                            <a class="toolsbox toolsbox-start" data-toggle="modal" data-target="#createCommunityModal"><i class="fa fa-fw  fa-group"></i> 建立社群</a>
                        </div>
						<!--div class="dropdown pull-right">
							<a id="notif-dropdown" class="toolsbox toolsbox-start dropdown-toggle" data-toggle="dropdown">訊息通知</a>
							<ul style="right:-35px;" class="subtoolsbox dropdown-menu" aria-labelledby="notif-dropdown">
                                <li><a>所有訊息</a></li>
                                <li><a>關閉</a></li>
                            </ul>
                        </div-->
						<p id="community-header-name" class="ng-binding"><img src="{{community.icon}}">{{community.n}}</p>
					</li>
				</ul>
			</div>
			<!--Community Header End -->
			<div id="wall">
				<div class="tab-content" ng-show="selectedTab == 1 ">
					<div class="general-box" style="margin:-1px">
						<div class="wall-title">
                            <span style="margin-left:10px;"/>
							<!--span class="wall-icon icon-title-community"></span-->
							<span class="post-wall-icon">?</span>
							<span>
    							<a ng-click="selectedTab1 = 1; searchQuery = '';" ng-class="{activeTabUnderlined: selectedTab1 == 1}">
                                    <font style="color: white;">問題</font>
    							</a>
							</span>
							<span style="margin-left:10px;"/>
							<!--span class="wall-icon icon-title-friendwall"></span-->
							<span class="post-wall-icon">♥</span>
							<span>
    							<a ng-click="selectedTab1 = 2; searchQuery = '';" ng-class="{activeTabUnderlined: selectedTab1 == 2}">
                                    <font style="color: white;">分享</font>
                                </a>
                            </span>
							<a ng-click="selectedTab1 = 3;" id="contentSearchwrapper" class="pull-right ng-pristine ng-valid">
                                <div class="basic-search-wrapper">
                                    <div class="input-group innerB basic-search">
                                        <input type="text" class="form-control" ng-model="searchQuery" placeholder="">
                                        <div class="input-group-btn">
                                           <button class="btn btn-default" type="button" ng-click="search_trigger = searchQuery">
                                               <i class="fa fa-search"></i>
                                           </button>
                                        </div>
                                    </div>
                                </div>
							</a>
						</div>
					</div>
					<div class="tab-content" ng-show="selectedTab1 == 1" id="qnapost" ng-controller="CreateQnACommunityController">
                        <div data-ng-include data-src="'/assets/app/views/community-QnA-bar.html'"></div>
                    </div>
                    <div class="tab-content" ng-show="selectedTab1 == 2" id="post">
						<div data-ng-include data-src="'/assets/app/views/community-post-bar.html'"></div>
					</div>
					<div class="tab-content" data-ng-show="selectedTab1 == 3" id="srchbar" data-ng-controller="SearchPageController">
						<input data-ng-model="search_trigger" type="hidden">
						<div data-ng-include data-src="'/assets/app/views/community-search-bar.html'"></div>
					</div>
				</div>
                <div class="tab-content row" ng-show="selectedTab == 2 ">
                    <div data-ng-controller="CommunityMembersWidgetController" data-ng-include data-src="'/assets/app/views/allMembersSection.html'"></div>
                </div>
            </div>
            <!--Wall End -->
		</div>
		<div class="col-md-4 col-sm-4 col-xs-4" style="width: 25%;">
			<div class="row">
				<!--button class="btn-general-b pull-right" data-toggle="modal"
					data-target="#createCommunityModal">
					<h4 style="display: inline;">+</h4>
					Create a group
				</button>
				<button ng-show="!community.isO && community.isM == true"
					class="btn-general-b pull-right"
					data-ng-click="leave_community(community.id)">
					<i class="fa fa-thumbs-down"></i> Leave
				</button>
				<button
					ng-show="!community.isO && community.isM == false && community.isP == false"
					class="btn-general-b pull-right"
					data-ng-click="send_join(community.id)">
					<i class="fa fa-user"></i> Join
				</button>
				<button ng-show="!community.isO && community.isP == true"
					class="btn-general-b pull-right" disabled="disabled">
					<i class="fa fa-user"></i> Pending
				</button-->
				
				<!--a style="margin:0 8px 8px 0" class="btn-general pull-right" data-toggle="modal" data-target="#createCommunityModal"><i class="fa fa-fw  fa-group"></i> 建立社群</a-->
				<!--a style="margin:0 8px 8px 0" ng-show="!community.isO && community.isM == true" class="btn-general pull-right" data-ng-click="leave_community(community.id)">退出社群</a-->
				<a style="margin:0 8px 8px 0" ng-show="!community.isO && community.isM == false && community.isP == false" class="btn-general pull-right" data-ng-click="send_join(community.id)">+ <i class="fa fa-user"></i> 加入社群</a>
                <a style="margin:0 8px 8px 0" ng-show="!community.isO && community.isP == true" class="btn-general pull-right" disabled="disabled"">已送出加入邀請</a>
			</div>
			<div id="about" class="general-box">
				<div class="con-title">
					<span class="icon-box icon-box-blueLight icon-title-profile-about"></span>關於
					<div class="pull-right">
						<a ng-click="selectedTab = 2;">{{community.nom}}位成員</a>
						<p data-ng-show="community.typ=='CLOSE'" class="small"><span class="glyphicon glyphicon-lock"></span>不公開的社群</p>
						<p data-ng-show="community.typ=='OPEN'" class="small">公開的社群</p>
					</div>
				</div>

				<div class="content-wrapper">
					<ul>
						<pre>{{community.d}}</pre>
					</ul>
				</div>
				<div class="content-wrapper">
					<ul>
						<li>
							<form id="commun-add-member-wrapper"
								name="commun-add-member-wrapper" method="post" action="">
								<label for="Add Member"></label> 
								<input type="text" name="add-member-field" id="add-member-field" class="general-textfield general-input-box" data-ng-model="searchQuery1"
									data-ng-keyup="search_unjoined_users(community.id, searchQuery1)" placeholder="+ 邀請新成員" />
								<div>
									<div class="row">
										<ul class="col-lg-12 col-md-11 col-sd-11 dropdown-menu chat media-list hide"
											ng-class="{show : nonMembers.length > 0 && searchQuery1.length > 0}"
											style="overflow-y: scroll; max-height: 244px;">
											<li class="media" ng-repeat="sr in nonMembers"
												ng-switch="sr.tp" style="margin-top: 2% !important;">
												<!-- shows user section --> 
                                                <a class="pull-left" href="#/profile/{{sr.id}}"> 
                                                    <img class="media-object thumb" data-ng-src="/get-mini-image-by-id/{{sr.id}}" alt="50x50" width="50"/>
                                                </a>
												<div class="media-body">
													<h5 class="media-heading">
												        {{sr.nm}} 
												        <i data-ng-click="send_invite_to_join(community.id, sr.id)" class="fa fa-plus-square pull-right"></i>
													</h5>
												</div>
											</li>
										</ul>
									</div>
								</div>
							</form>
						</li>
					</ul>
				</div>
			</div>
			<div ng-controller="RecommendedCommunityWidgetController" data-ng-show="result.fvm.length > 0">
				<div data-ng-include style="width: 100%;" data-src="'/assets/app/views/utilities/yourFriendsCommunitiesUtility.html'"></div>
			</div>
			<!--NewCommunity End -->
		</div>
	</div>
</div>
<div class="padding20"></div>

<div data-ng-include data-src="'/assets/app/views/createCommunityModal.html'"></div>

<div class="modal fade lightbox" id="imageModal" data-backdrop="false" style="float: left;">
  <div class="modal-dialog" >
    <div class="modal-content pull-left" >
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
        <h4 class="modal-title" id="myModalLabel"></h4>
      </div>
      <div class="modal-body">
       		<img data-ng-src="/get-original-post-image-by-id/{{img_id}}" alt="" style="max-width: 100%;">
      </div>
    </div>
  </div>
</div>

<div id="back-to-top" ng-controller="UIController">
    <a ng-click="gotoTop()"><span class="icon-title-arrow-up"></span>Top</a>
</div>

<script type="text/ng-template" id="change-profile-photo-modal.html">
    <div class="modal-header">
        <button type="button" ng-click="close()" class="close" data-dismiss="modal">&times;</button>
        <h4 class="modal-title">更換封面相片</h4>
    </div>
    <div class="modal-body">
        <input type="file" ng-file-select="onFileSelect($files)" >
        <div ng-file-drop="onFileSelect($files)" class="drop-box" ng-show="dropSupported">相片放到這裡</div>
        <div ng-file-drop-available="dropSupported=true" ng-show="!dropSupported">HTML5 相片拖放工能不支援!</div>
        <br/><br/>
        <div ng-show="selectedFiles != null">
            <div class="sel-file" ng-repeat="f in selectedFiles">
                <button class="button" ng-click="start($index)" ng-show="progress[$index] < 0">開始</button>
                <button class="button" ng-click="abort($index)" ng-show="hasUploader($index) && progress[$index] < 100">終止</button>
                {{f.name}} - size: {{f.size}}B - type: {{f.type}}
            </div>
        </div>
        <div class="response" ng-show="uploadResult.length > 0">
            <ul>
                <li ng-repeat="result in uploadResult">
                    <ul>
                        <li ng-repeat="item in result.result">
                            <div data-ng-show="item.name">檔案名稱: {{item.name}}</div>
                            <div data-ng-show="item.fieldName">名稱: {{item.fieldName}}</div>
                            <div data-ng-show="item.size">size: {{item.size}}</div>
                            <div data-ng-show="item.value">value: {{item.value}}</div>
                        </li>
                    </ul>
                    <div data-ng-show="result.requestHeaders" class="reqh">request headers: {{result.requestHeaders}}</div>
                </li>
            </ul>
        </div>
    </div>
    <div class="modal-footer"></div>
</script>
